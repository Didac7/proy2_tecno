import{r as p,q as k,k as y,a,c as u,d as m,t as o,g as d,m as r,F as h,x as B,w as E,p as P,z as q}from"./app-DEf1IR0b.js";import{A as x}from"./AppLayout-jejGCWhL.js";import{_ as A}from"./_plugin-vue_export-helper-DlAUqK2U.js";/* empty css            */const w={class:"cuotas-container"},D={class:"cuotas-card"},$={class:"cuotas-header"},F={class:"plan-info"},L={class:"cuotas-list"},M={class:"cuota-info"},N={class:"cuota-actions"},R={key:0,class:"badge-pagado"},S={key:1,class:"actions-group"},V=["onClick","disabled"],O=["onClick","disabled"],Q={class:"qr-container"},T=["src"],j={__name:"Cuotas",props:{pago:Object,plan:Object,cuotas:Array},setup(n){const f=n,l=p(!1),c=p(null),i=p(null),C=async e=>{l.value=!0;try{const t=await P.post(`/api/cuotas/${e}/pagar`);t.data.success&&(c.value=t.data.qr,i.value=f.cuotas.find(s=>s.id_cuota===e))}catch{alert("Error al generar QR")}finally{l.value=!1}},_=async e=>{if(confirm("Â¿Confirmar cobro en efectivo de esta cuota?")){l.value=!0;try{q.post(`/pagos/cuotas/${e}/pagar-efectivo`,{},{onSuccess:()=>{alert("Pago de cuota registrado correctamente")},onError:()=>{alert("Error al registrar el pago")},onFinish:()=>{l.value=!1}})}catch{alert("Error al procesar el pago"),l.value=!1}}},g=()=>{c.value=null,i.value=null},v=e=>e?new Date(e).toLocaleDateString("es-BO"):"";return(e,t)=>(r(),k(x,null,{default:y(()=>[a("div",w,[a("div",D,[a("div",$,[t[1]||(t[1]=a("h1",null,"ðŸ“… Plan de Cuotas",-1)),a("p",null,"Paquete: "+o(n.pago.paquete?.codigo_seguimiento),1)]),a("div",F,[t[5]||(t[5]=a("h3",null,"ðŸ“Š Resumen del Plan",-1)),a("p",null,[t[2]||(t[2]=a("strong",null,"Total:",-1)),d(" Bs. "+o(n.pago.monto_total),1)]),a("p",null,[t[3]||(t[3]=a("strong",null,"Cuotas:",-1)),d(" "+o(n.plan.numero_cuotas)+" x Bs. "+o(n.plan.monto_cuota),1)]),a("p",null,[t[4]||(t[4]=a("strong",null,"Pagadas:",-1)),d(" "+o(n.plan.cuotas_pagadas)+" / "+o(n.plan.numero_cuotas),1)])]),a("div",L,[t[6]||(t[6]=a("h3",null,"ðŸ’³ Cuotas",-1)),(r(!0),u(h,null,B(n.cuotas,s=>(r(),u("div",{key:s.id_cuota,class:"cuota-item"},[a("div",M,[a("h4",null,"Cuota "+o(s.numero_cuota),1),a("p",null,"Monto: Bs. "+o(s.monto),1),a("p",null,"Vence: "+o(v(s.fecha_vencimiento)),1)]),a("div",N,[s.estado==="PAGADA"?(r(),u("span",R," âœ… Pagada el "+o(v(s.fecha_pago)),1)):(r(),u("div",S,[a("button",{onClick:b=>C(s.id_cuota),class:"btn-pagar-cuota",disabled:l.value}," ðŸ’³ Pagar con QR ",8,V),e.$page.props.auth.user.tipo_usuario!=="CLIENTE"?(r(),u("button",{key:0,onClick:b=>_(s.id_cuota),class:"btn-pagar-efectivo",disabled:l.value}," ðŸ’° Cobrar Efectivo ",8,O)):m("",!0)]))])]))),128))]),c.value?(r(),u("div",{key:0,class:"modal-overlay",onClick:g},[a("div",{class:"modal-content",onClick:t[0]||(t[0]=E(()=>{},["stop"]))},[a("h3",null,"ðŸ“± Escanea para pagar Cuota "+o(i.value?.numero_cuota),1),a("div",Q,[a("img",{src:"data:image/png;base64,"+c.value.qrBase64,alt:"QR Cuota"},null,8,T)]),a("p",null,[t[7]||(t[7]=d("Monto: ",-1)),a("strong",null,"Bs. "+o(i.value?.monto),1)]),a("button",{onClick:g,class:"btn-cerrar"},"Cerrar")])])):m("",!0)])])]),_:1}))}},J=A(j,[["__scopeId","data-v-d9390393"]]);export{J as default};
